<!doctype html><html lang="hu"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>FitnessLady – Regisztráció</title>
<style>
body{margin:0;min-height:100vh;display:grid;place-items:center;background:#0b0c12;color:#fff;font-family:system-ui}
.card{width:min(520px,92vw);padding:22px;border-radius:18px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12)}
input,button{width:100%;padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.16);background:rgba(0,0,0,.25);color:#fff}
button{border:0;margin-top:12px;background:#7c3aed;font-weight:700;cursor:pointer}
.msg{margin-top:10px;min-height:18px}
.ok{color:#7CFFB2}.err{color:#FF6B6B}
</style></head><body>
<div class="card">
  <h2>Fiók aktiválása</h2>
  <p>Állíts be jelszót (min. 8 karakter).</p>
  <input id="p1" type="password" placeholder="Új jelszó">
  <input id="p2" type="password" placeholder="Jelszó ismét" style="margin-top:10px">
  <button id="btn">Jelszó beállítása</button>
  <div id="msg" class="msg"></div>
  <div style="margin-top:10px;opacity:.85"><a href="/hu/login/" style="color:#9ad1ff">Belépés</a></div>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbx2SHjREtP-FkNwzm3mKdEgV5Gqlg_LMgZw6aW-lm1Fh7rIeIcgCCPUhi61Iv7B9p2F/exec"; // <-- ide a /exec

const token = new URLSearchParams(location.search).get("t");
const msg = (t,c)=>{const el=document.getElementById("msg"); el.className="msg "+(c||""); el.textContent=t||"";};

document.getElementById("btn").onclick = async () => {
  msg("");
  if(!token) return msg("Hiányzó token (t=...)", "err");

  const p1 = document.getElementById("p1").value;
  const p2 = document.getElementById("p2").value;
  if(p1.length < 8) return msg("Min. 8 karakter kell.", "err");
  if(p1 !== p2) return msg("A két jelszó nem egyezik.", "err");

  const btn = document.getElementById("btn");
  btn.disabled = true;

  try{
    const res = await fetch(API_URL, {
      method:"POST",
      headers:{ "Content-Type":"text/plain;charset=utf-8" },
      body: JSON.stringify({ action:"authSetPassword", reg_token: token, new_password: p1 })
    });
    const data = await res.json();
    if(!data.ok) return msg("Hiba: "+(data.error||"UNKNOWN"), "err");
    msg("Sikeres! Most már be tudsz lépni.", "ok");
    setTimeout(()=>location.href="/hu/login/", 800);
  }catch(e){
    msg("Hálózati hiba: "+e.message, "err");
  }finally{
    btn.disabled = false;
  }
};
</script>
</body></html>

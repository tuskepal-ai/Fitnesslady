<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fitness Lady ‚Äî Saj√°t programom (Teszt)</title>
  <meta name="description" content="Fitness Lady ‚Äî Saj√°t programom: csomag, heti edz√©sek, szem√©lyre szab√°s slotok, √©trend, check-in/c√©l, technika vault." />

  <style>
    :root{
      --bg:#07060b;
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.70);
      --muted2:rgba(255,255,255,.55);

      --pink:#ff4fd8;
      --pink2:#b14cff;
      --gold:#ffd38a;

      --radius:22px;
      --shadow: 0 18px 55px rgba(0,0,0,.55);
      --max: 1180px;

      --glassA: rgba(255,255,255,.06);
      --glassB: rgba(255,255,255,.02);
      --stroke: rgba(255,255,255,.10);
      --stroke2: rgba(255,255,255,.14);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    html{ scroll-behavior:smooth; }

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(1200px 700px at 30% 10%, rgba(255,79,216,.16), transparent 60%),
        radial-gradient(1000px 700px at 75% 20%, rgba(177,76,255,.14), transparent 60%),
        radial-gradient(1000px 700px at 60% 90%, rgba(255,211,138,.06), transparent 55%),
        var(--bg);
      color:var(--text);
      overflow-x:hidden;
    }

    /* Full page hero.png background (same as main) */
    body::before{
      content:"";
      position: fixed;
      inset: 0;
      z-index: -1;
      background-image: url("/hero.png");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      transform: translateZ(0);
      opacity:.92;
    }

    a{ color:inherit; text-decoration:none; }
    button{ font:inherit; }

    .container{
      width: min(var(--max), 92vw);
      margin: 0 auto;
    }

    /* ===== Topbar ===== */
    .topbar{
      position: fixed;
      top:0; left:0; right:0;
      z-index: 50;
      background: rgba(8,6,12,.55);
      border-bottom: 1px solid rgba(255,255,255,.06);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }
    .topbar-inner{
      height: 64px;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 12px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight:800;
      letter-spacing:.2px;
      white-space: nowrap;
    }
    .dot{
      width:10px;height:10px;border-radius:999px;
      background: radial-gradient(circle at 30% 30%, #ffd0f6, var(--pink));
      box-shadow: 0 0 18px rgba(255,79,216,.7);
      flex: 0 0 auto;
    }

    .nav{
      display:flex;
      align-items:center;
      gap: 14px;
      color: var(--muted);
      font-size: 13.5px;
      font-weight: 700;
    }
    .nav a{
      position: relative;
      padding: 10px 6px;
      opacity:.92;
    }
    .nav a:hover{ opacity:1; color: var(--text); }
    .nav a::after{
      content:"";
      position:absolute;
      left: 8px; right: 8px; bottom: 6px;
      height: 2px;
      border-radius: 99px;
      background: linear-gradient(90deg, rgba(255,215,140,0), rgba(255,215,140,.9), rgba(255,215,140,0));
      transform: scaleX(0);
      transform-origin: left;
      opacity: 0;
      transition: transform .28s ease, opacity .28s ease;
    }
    .nav a:hover::after,
    .nav a.is-active::after{
      transform: scaleX(1);
      opacity: 1;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding: 9px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(20,12,26,.55);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      color: var(--text);
      box-shadow: 0 12px 34px rgba(0,0,0,.35);
      cursor:pointer;
      transition: transform .18s ease, border-color .18s ease, background .18s ease;
      user-select:none;
      white-space: nowrap;
      gap:8px;
    }
    .pill:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.20); }
    .pill.primary{
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      color:#140813;
      border-color: rgba(255,255,255,.18);
      box-shadow: 0 18px 46px rgba(255,79,216,.26);
      font-weight: 900;
    }
    .pill.ghost{ background: rgba(255,255,255,.06); }
    .pill.danger{ background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.14); }

    .menu-btn{
      width: 40px; height: 40px; border-radius: 999px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      color: var(--text);
      display:none;
      align-items:center; justify-content:center;
      cursor:pointer;
    }

    /* ===== Layout ===== */
    main{
      padding-top: 64px;
      min-height: 100vh;
      min-height: 100dvh;
    }
    .page{
      padding: 18px 0 64px;
    }

    .glass{
      background: linear-gradient(180deg, var(--glassA), var(--glassB));
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
    }

    .interactive{
      position: relative;
      overflow: hidden;
      transition: transform .30s cubic-bezier(.2,.8,.2,1), box-shadow .30s ease, border-color .30s ease;
      will-change: transform;
    }
    .interactive::before{
      content:"";
      position:absolute; inset:-3px;
      border-radius: inherit;
      background:
        radial-gradient(700px 240px at 12% 0%, rgba(255,79,216,.32), transparent 55%),
        radial-gradient(700px 260px at 90% 20%, rgba(177,76,255,.26), transparent 60%);
      opacity: 0;
      filter: blur(6px);
      transition: opacity .30s ease;
      pointer-events:none;
    }
    .interactive:hover,
    .interactive:focus-visible,
    .interactive.is-active{
      transform: translateY(-4px);
      border-color: rgba(255,255,255,.16);
      box-shadow: 0 22px 70px rgba(0,0,0,.55);
    }
    .interactive:hover::before,
    .interactive:focus-visible::before,
    .interactive.is-active::before{ opacity: 1; }

    .grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 14px;
      align-items:start;
    }
    @media (max-width: 980px){
      .grid{ grid-template-columns: 1fr; }
      .nav{ display:none; }
      .menu-btn{ display:inline-flex; }
    }

    /* ===== Cards ===== */
    .card{ padding: 16px; }
    .card h2, .card h3{
      margin:0 0 8px;
      font-family: ui-serif, Georgia, "Times New Roman", Times, serif;
      letter-spacing: -.2px;
    }
    .card h2{ font-size: 22px; }
    .card h3{ font-size: 18px; }
    .sub{
      margin:0 0 12px;
      color: var(--muted);
      line-height: 1.55;
      font-size: 13.5px;
    }

    .meta-row{
      display:flex; flex-wrap:wrap;
      gap: 10px;
      margin-top: 10px;
      color: var(--muted2);
      font-size: 12.8px;
    }
    .meta-pill{
      display:inline-flex; align-items:center; gap:8px;
      padding: 9px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    /* ===== Progress ===== */
    .progress{
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 999px;
      height: 12px;
      overflow:hidden;
      position:relative;
    }
    .progress > span{
      display:block;
      height:100%;
      width: 0%;
      background: linear-gradient(90deg, rgba(255,79,216,.95), rgba(177,76,255,.90));
      border-radius: 999px;
      transition: width .35s ease;
    }
    .progress-label{
      display:flex;
      justify-content: space-between;
      gap: 10px;
      font-size: 12.5px;
      color: var(--muted2);
      margin: 10px 0 8px;
    }

    /* ===== Tabs ===== */
    .tabs{
      display:flex;
      flex-wrap:wrap;
      gap: 8px;
      margin: 8px 0 12px;
    }
    .tab{
      padding: 8px 11px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.86);
      cursor:pointer;
      font-size: 13px;
      font-weight: 850;
      user-select:none;
    }
    .tab.is-active{
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      color:#140813;
      border-color: rgba(255,255,255,.18);
    }

    /* ===== Workout list ===== */
    .list{ margin:0; padding:0; list-style:none; display:grid; gap:10px; }
    .row{
      display:grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      align-items:center;
      padding: 12px;
      border-radius: 18px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
    }
    .row .title{
      font-weight: 900;
      letter-spacing:.2px;
      font-size: 13.5px;
    }
    .row .desc{
      color: var(--muted);
      font-size: 12.8px;
      margin-top: 4px;
      line-height: 1.45;
    }
    .row .actions{
      display:flex;
      gap: 8px;
      justify-content:flex-end;
      flex-wrap:wrap;
    }
    .tiny{
      padding: 8px 10px;
      font-size: 12.5px;
      border-radius: 999px;
    }

    .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.07);
      color: var(--muted);
      white-space: nowrap;
      font-weight: 850;
      font-size: 12px;
    }

    /* ===== Section anchors ===== */
    section{ scroll-margin-top: 82px; }

    /* ===== Modal ===== */
    .modal-overlay{
      position: fixed;
      inset: 0;
      z-index: 80;
      background: rgba(0,0,0,.58);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 18px;
    }
    .modal-overlay.is-open{ display:flex; }

    .modal{
      width: min(980px, 94vw);
      max-height: min(82vh, 760px);
      border-radius: var(--radius);
      overflow: hidden;
      position: relative;
    }
    .modal-header{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      padding: 14px 16px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: rgba(10,8,14,.45);
    }
    .modal-title{
      margin:0;
      font-family: ui-serif, Georgia, "Times New Roman", Times, serif;
      font-size: 20px;
      letter-spacing: -.2px;
    }
    .modal-close{
      width: 40px; height: 40px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.9);
      cursor: pointer;
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }
    .modal-body{
      padding: 16px;
      overflow: auto;
      max-height: calc(min(82vh, 760px) - 64px);
      background: rgba(7,6,11,.38);
    }
    .modal-body h4{
      margin: 12px 0 8px;
      font-size: 15px;
      font-weight: 950;
      letter-spacing: .1px;
    }
    .modal-body p{
      margin: 0 0 10px;
      color: var(--muted);
      line-height: 1.6;
      font-size: 13.5px;
    }
    .field{
      display:grid;
      gap: 8px;
      margin: 10px 0 12px;
    }
    label{
      font-size: 12.5px;
      color: var(--muted2);
      font-weight: 850;
    }
    input{
      width:100%;
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
      color: rgba(255,255,255,.92);
      outline: none;
    }
    input:focus{ border-color: rgba(255,255,255,.22); }

    .note{
      color: var(--muted2);
      font-size: 12.6px;
      line-height: 1.55;
    }

    /* ===== Footer ===== */
    footer{
      padding: 18px 0 46px;
      border-top:1px solid rgba(255,255,255,.08);
      background: rgba(10,8,14,.55);
      backdrop-filter: blur(10px);
    }
    .footer-inner{
      display:flex;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      color:rgba(255,255,255,.70);
      font-size:13px;
    }

    /* Reduce motion */
    @media (prefers-reduced-motion: reduce){
      html{ scroll-behavior:auto; }
      .interactive, .pill{ transition:none; }
      .progress > span{ transition:none; }
    }
  </style>
</head>

<body>
  <!-- TOPBAR -->
  <header class="topbar">
    <div class="container topbar-inner">
      <!-- ha n√°lad /hu/ a f≈ëoldal, ezt nyugodtan cser√©ld /hu/-ra -->
      <a class="brand" href="/hu/" aria-label="Vissza a f≈ëoldalra">
        <span class="dot"></span>
        <span>Fitness Lady</span>
      </a>

      <nav class="nav" aria-label="Vev≈ë men√º">
        <a href="#program" data-nav>Programom</a>
        <a href="#etrend" data-nav>√âtrend</a>
        <a href="#checkin" data-nav>C√©lom & Check-in</a>
        <a href="#technika" data-nav>Technika</a>
      </nav>

      <div style="display:flex; align-items:center; gap:10px;">
        <button class="menu-btn" id="menuBtn" aria-label="Men√º">‚ò∞</button>
        <button class="pill ghost" id="btnLogout" type="button" title="Kijelentkez√©s">‚éã Kil√©p√©s</button>
      </div>
    </div>
  </header>

  <main>
    <div class="container page">

      <!-- HERO / STATUS -->
      <section id="top" class="glass interactive card" style="margin-bottom:14px;">
        <div style="display:flex; align-items:flex-start; justify-content:space-between; gap:12px; flex-wrap:wrap;">
          <div>
            <div class="chip" id="chipPackage">Csomag: ‚Äî</div>
            <h2 style="margin-top:10px;">Saj√°t programom</h2>
            <p class="sub" id="subStatus">Bet√∂lt√©s‚Ä¶</p>
          </div>

          <div style="display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end;">
            <button class="pill primary" id="btnRenew" type="button">Meg√∫j√≠t√°s</button>
            <button class="pill ghost" id="btnUpgrade" type="button">Upgrade</button>
            <button class="pill ghost" id="btnOpenSettings" type="button">Be√°ll√≠t√°sok</button>
          </div>
        </div>

        <div class="progress-label">
          <span id="lblWeek">H√©t: ‚Äî</span>
          <span id="lblDays">H√°tral√©v≈ë napok: ‚Äî</span>
        </div>
        <div class="progress" aria-label="Ciklus halad√°s">
          <span id="barCycle"></span>
        </div>

        <div class="meta-row">
          <div class="meta-pill" id="pillGoal">üéØ C√©l: ‚Äî</div>
          <div class="meta-pill" id="pillIntensity">‚ö° Szint: ‚Äî</div>
          <div class="meta-pill" id="pillUpdated">‚ú® Utols√≥ friss√≠t√©s: ‚Äî</div>
        </div>
      </section>

      <div class="grid">
        <!-- LEFT: Program -->
        <section id="program" class="glass interactive card">
          <h3>Heti edz√©sek</h3>
          <p class="sub">Heti bont√°sban l√°tod az edz√©seidet. A ‚ÄúSzem√©lyre szab√°s‚Äù slotokat Edina hetente 1‚Äì2 alkalommal friss√≠ti.</p>

          <div class="tabs" id="weekTabs" aria-label="H√©t v√°laszt√≥"></div>

          <div style="display:flex; gap:10px; flex-wrap:wrap; margin: 0 0 10px;">
            <button class="pill ghost tiny" id="btnMarkAll" type="button">‚úÖ Heti edz√©sek kipip√°l√°sa</button>
            <button class="pill ghost tiny" id="btnResetWeek" type="button">‚Ü∫ H√©t √∫jraind√≠t√°sa</button>
            <button class="pill ghost tiny" id="btnOpenPlayerHelp" type="button">‚ÑπÔ∏è Lej√°tsz√°s info</button>
          </div>

          <ul class="list" id="workoutList"></ul>

          <hr style="border:none; height:1px; background:rgba(255,255,255,.08); margin: 14px 0;" />

          <h3>Szem√©lyre szab√°s</h3>
          <p class="sub">A slotok csak a te programodhoz tartoz√≥ vide√≥kat mutatj√°k. M√°s csomag tartalma nem l√°that√≥.</p>
          <ul class="list" id="slotList"></ul>
        </section>

        <!-- RIGHT: Diet + Check-in -->
        <div style="display:grid; gap:14px;">
          <!-- √âtrend -->
          <section id="etrend" class="glass interactive card">
            <h3>√âtrend</h3>
            <p class="sub">Ez a r√©sz most teszt. K√©s≈ëbb finom√≠tjuk, hogyan n√©zzen ki (napi bont√°s, sablonok, k√©pek).</p>

            <div class="row" style="grid-template-columns: 1fr; gap:8px;">
              <div>
                <div class="title">Mai keret (teszt)</div>
                <div class="desc">Pip√°ld ki, ami megvan ‚Äî motiv√°ci√≥ √©s ritmus.</div>
              </div>
              <div style="display:grid; gap:8px;">
                <div style="display:flex; gap:8px; flex-wrap:wrap;">
                  <button class="pill ghost tiny" data-toggle="diet_water" type="button">üíß 2L v√≠z</button>
                  <button class="pill ghost tiny" data-toggle="diet_protein" type="button">ü•ö Feh√©rje megvolt</button>
                  <button class="pill ghost tiny" data-toggle="diet_steps" type="button">üëü 8k l√©p√©s</button>
                  <button class="pill ghost tiny" data-toggle="diet_sleep" type="button">üåô Alv√°s rendben</button>
                </div>
                <div class="note" id="dietNote">Tipp: k√©s≈ëbb ide j√∂n a napi √©tkez√©s-sablon (Reggeli/Eb√©d/Vacsora/Snack) + opcion√°lis k√©p √©tkez√©senk√©nt.</div>
              </div>
            </div>

            <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;">
              <button class="pill primary tiny" id="btnDietPlan" type="button">Napi √©tkez√©s (teszt)</button>
              <button class="pill ghost tiny" id="btnDietPrefs" type="button">Preferenci√°k</button>
            </div>
          </section>

          <!-- C√©lom / Check-in + motiv√°ci√≥ -->
          <section id="checkin" class="glass interactive card">
            <h3>C√©lom & Check-in</h3>
            <p class="sub">Itt l√°tod a c√©lodat, a heti check-in √°llapotot √©s egy motiv√°l√≥ √ºzenetet.</p>

            <div class="row" style="grid-template-columns: 1fr; gap:10px;">
              <div>
                <div class="title" id="goalTitle">üéØ C√©l: ‚Äî</div>
                <div class="desc" id="goalDesc">‚Äî</div>
              </div>

              <div style="display:grid; gap:8px;">
                <div class="progress-label" style="margin:0;">
                  <span>Heti check-in</span>
                  <span id="checkinLabel">0/1</span>
                </div>
                <div class="progress"><span id="barCheckin"></span></div>

                <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:4px;">
                  <button class="pill primary tiny" id="btnDoCheckin" type="button">Check-in kit√∂lt√©se</button>
                  <button class="pill ghost tiny" id="btnMotivation" type="button">Motiv√°ci√≥</button>
                </div>

                <div class="note" id="motivationBox">‚ÄûA rendszer nem nyom√°s. A rendszer szabads√°g.‚Äù</div>
              </div>
            </div>
          </section>
        </div>
      </div>

      <!-- Technika Vault -->
      <section id="technika" class="glass interactive card" style="margin-top:14px;">
        <div style="display:flex; align-items:flex-end; justify-content:space-between; gap:12px; flex-wrap:wrap;">
          <div>
            <h3>Technika Vault (√∂r√∂k)</h3>
            <p class="sub">Ez a r√©sz akkor is el√©rhet≈ë marad, ha a csomagod lej√°r. (Indul√°s: 8‚Äì12 vide√≥.)</p>
          </div>
          <button class="pill ghost tiny" id="btnAddTechDone" type="button">‚úÖ Technik√°k kipip√°l√°sa</button>
        </div>

        <div class="tabs" id="techTabs" aria-label="Technika kateg√≥ri√°k"></div>
        <ul class="list" id="techList"></ul>
      </section>
    </div>
  </main>

  <footer>
    <div class="container footer-inner">
      <div>¬© <span id="y"></span> Fitness Lady ‚Äî Teszt vev≈ë oldal</div>
      <div>T√ºske web design</div>
    </div>
  </footer>

  <!-- AUTH MODAL -->
  <div class="modal-overlay" id="authOverlay" role="dialog" aria-modal="true" aria-labelledby="authTitle" aria-hidden="true">
    <div class="glass modal" role="document">
      <div class="modal-header">
        <h2 class="modal-title" id="authTitle">Bel√©p√©s / Fi√≥k aktiv√°l√°s</h2>
        <button class="modal-close interactive" id="authClose" type="button" aria-label="Bez√°r√°s">‚úï</button>
      </div>
      <div class="modal-body">
        <p class="note" style="margin-bottom:12px;">
          Teszt verzi√≥: a bel√©p√©s √©s a fi√≥k aktiv√°l√°s <b>localStorage</b>-ban t√∂rt√©nik (nincs backend).
          √âlesben ezt majd fizet√©s + e-mail aktiv√°l√°s + jogosults√°g adja.
        </p>

        <div class="field">
          <label for="email">E-mail</label>
          <input id="email" type="email" placeholder="pl. fitnesslady92@gmail.com" autocomplete="email" />
        </div>

        <div id="activateBlock">
          <div class="field">
            <label for="pw1">Jelsz√≥ (√∫j)</label>
            <input id="pw1" type="password" placeholder="Legal√°bb 6 karakter" autocomplete="new-password" />
          </div>
          <div class="field">
            <label for="pw2">Jelsz√≥ (ism√©t)</label>
            <input id="pw2" type="password" placeholder="Ism√©teld meg" autocomplete="new-password" />
          </div>
          <button class="pill primary" id="btnActivate" type="button">Fi√≥k aktiv√°l√°sa</button>
          <p class="note" style="margin-top:10px;">Ha m√°r van fi√≥kod, alul bel√©psz jelsz√≥val.</p>
          <hr style="border:none; height:1px; background:rgba(255,255,255,.08); margin: 14px 0;" />
        </div>

        <div id="loginBlock">
          <div class="field">
            <label for="pw">Jelsz√≥</label>
            <input id="pw" type="password" placeholder="Jelszavad" autocomplete="current-password" />
          </div>
          <div style="display:flex; gap:10px; flex-wrap:wrap;">
            <button class="pill primary" id="btnLogin" type="button">Bel√©p√©s</button>
            <button class="pill ghost" id="btnResetPw" type="button">Elfelejtett jelsz√≥ (teszt)</button>
          </div>
          <p class="note" id="authMsg" style="margin-top:10px;"></p>
        </div>
      </div>
    </div>
  </div>

  <!-- SETTINGS MODAL -->
  <div class="modal-overlay" id="settingsOverlay" role="dialog" aria-modal="true" aria-labelledby="settingsTitle" aria-hidden="true">
    <div class="glass modal" role="document">
      <div class="modal-header">
        <h2 class="modal-title" id="settingsTitle">Be√°ll√≠t√°sok (teszt)</h2>
        <button class="modal-close interactive" id="settingsClose" type="button" aria-label="Bez√°r√°s">‚úï</button>
      </div>
      <div class="modal-body">
        <p class="note">Itt tudod tesztben √°t√°ll√≠tani a csomagot, c√©lt, szintet √©s a ciklus d√°tumokat. √âlesben ezt az admin oldalon √°ll√≠tod majd.</p>

        <div class="field">
          <label for="setPackage">Csomag</label>
          <input id="setPackage" type="text" placeholder="Start / Balance / Pro" />
        </div>

        <div class="field">
          <label for="setGoal">C√©l</label>
          <input id="setGoal" type="text" placeholder="pl. form√°l√°s / fogy√°s / er≈ë" />
        </div>

        <div class="field">
          <label for="setLevel">Szint (1‚Äì4)</label>
          <input id="setLevel" type="number" min="1" max="4" />
        </div>

        <div class="field">
          <label for="setStart">Ciklus kezdete (YYYY-MM-DD)</label>
          <input id="setStart" type="text" placeholder="2026-02-10" />
        </div>

        <div class="field">
          <label for="setEnd">Ciklus v√©ge (YYYY-MM-DD)</label>
          <input id="setEnd" type="text" placeholder="2026-03-10" />
        </div>

        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <button class="pill primary" id="btnSaveSettings" type="button">Ment√©s</button>
          <button class="pill ghost" id="btnResetDemo" type="button">Demo vissza√°ll√≠t√°s</button>
        </div>

        <p class="note" style="margin-top:10px;">
          Tipp: k√©s≈ëbb ezek a mez≈ëk egy admin t√°bl√°b√≥l/DB-b≈ël j√∂nnek, √©s a vev≈ë oldala csak renderel.
        </p>
      </div>
    </div>
  </div>

  <!-- SMALL MODAL: VIDEO PLAYER / DIET -->
  <div class="modal-overlay" id="infoOverlay" role="dialog" aria-modal="true" aria-labelledby="infoTitle" aria-hidden="true">
    <div class="glass modal" role="document">
      <div class="modal-header">
        <h2 class="modal-title" id="infoTitle">Info</h2>
        <button class="modal-close interactive" id="infoClose" type="button" aria-label="Bez√°r√°s">‚úï</button>
      </div>
      <div class="modal-body" id="infoBody"></div>
    </div>
  </div>

  <script>
    // ===== Helpers =====
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    const todayISO = () => new Date().toISOString().slice(0,10);
    const clamp = (n,min,max)=>Math.max(min,Math.min(max,n));
    const daysBetween = (a,b)=>Math.round((new Date(b)-new Date(a))/86400000);
    const fmtDate = (iso)=>{
      if(!iso) return "‚Äî";
      const d = new Date(iso+"T00:00:00");
      const dd = String(d.getDate()).padStart(2,"0");
      const mm = String(d.getMonth()+1).padStart(2,"0");
      const yy = d.getFullYear();
      return `${yy}.${mm}.${dd}`;
    };
    const escapeHtml = (s) => String(s ?? "").replace(/[&<>"']/g, c => ({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
    }[c]));

    // structuredClone fallback
    function clone(obj){
      try{
        if (typeof structuredClone === "function") return structuredClone(obj);
      }catch{}
      return JSON.parse(JSON.stringify(obj));
    }

    // Touch glow
    function enableTapGlow(selector=".interactive"){
      $$(selector).forEach(el=>{
        el.addEventListener("touchstart", ()=>{
          el.classList.add("is-active");
          window.clearTimeout(el.__t);
          el.__t = window.setTimeout(()=>el.classList.remove("is-active"), 650);
        }, {passive:true});
      });
    }
    enableTapGlow();

    // ===== Demo data (later: from backend / JSON) =====
    const DEMO = {
      profile: {
        userId: "demo-001",
        email: "demo@fitnesslady.ch",
        package: "Start",
        goal: "Form√°l√°s",
        level: 2,
        cycleStart: "2026-02-10",
        cycleEnd: "2026-03-10",
        lastUpdated: "2026-02-13",
        checkinDone: 0
      },
      packages: {
        Start: { weeks: 4, workoutsPerWeek: 3, slotsPerWeek: 1 },
        Balance: { weeks: 6, workoutsPerWeek: 4, slotsPerWeek: 2 },
        Pro: { weeks: 8, workoutsPerWeek: 4, slotsPerWeek: 2 }
      },
      plans: {
        Start: [
          { week: 1, workouts: [
              { id:"W1-A", title:"Edz√©s A ‚Äî Full body (alap)", desc:"Technika + ritmus. 35‚Äì45 perc.", video:"https://player.vimeo.com/video/000000001" },
              { id:"W1-B", title:"Edz√©s B ‚Äî Als√≥test f√≥kusz", desc:"Farizom + comb, kontroll√°lt temp√≥.", video:"https://player.vimeo.com/video/000000002" },
              { id:"W1-C", title:"Edz√©s C ‚Äî Core + form√°l√°s", desc:"T√∂rzs stabilit√°s + finisher.", video:"https://player.vimeo.com/video/000000003" }
            ],
            slots: [
              { slot:"Slot 1", title:"Szem√©lyre szabott csere", desc:"Edina hetente 1 alkalommal friss√≠ti.", video:"https://player.vimeo.com/video/000000010", note:"Most: glute f√≥kusz (k√≠m√©l≈ë)." }
            ]
          },
          { week: 2, workouts: [
              { id:"W2-A", title:"Edz√©s A ‚Äî Full body (progresszi√≥)", desc:"Kicsit t√∂bb intenzit√°s, 35‚Äì45 perc.", video:"https://player.vimeo.com/video/000000004" },
              { id:"W2-B", title:"Edz√©s B ‚Äî Als√≥test + core", desc:"Farizom + core komb√≥.", video:"https://player.vimeo.com/video/000000005" },
              { id:"W2-C", title:"Edz√©s C ‚Äî Form√°sod√°s", desc:"Stabil terhel√©s, tarthat√≥.", video:"https://player.vimeo.com/video/000000006" }
            ],
            slots: [
              { slot:"Slot 1", title:"Szem√©lyre szabott csere", desc:"Halad√°s alapj√°n m√≥dos√≠tva.", video:"https://player.vimeo.com/video/000000011", note:"Most: core stabilit√°s (szint 2)." }
            ]
          },
          { week: 3, workouts: [
              { id:"W3-A", title:"Edz√©s A ‚Äî Full body (er≈ësebb)", desc:"R√∂videbb pihen≈ë, 35‚Äì45 perc.", video:"https://player.vimeo.com/video/000000007" },
              { id:"W3-B", title:"Edz√©s B ‚Äî Als√≥test (progresszi√≥)", desc:"T√©rdbar√°t opci√≥kkal.", video:"https://player.vimeo.com/video/000000008" },
              { id:"W3-C", title:"Edz√©s C ‚Äî Core + cardio light", desc:"Low impact finisher.", video:"https://player.vimeo.com/video/000000009" }
            ],
            slots: [
              { slot:"Slot 1", title:"Szem√©lyre szabott csere", desc:"Edina friss√≠tette.", video:"https://player.vimeo.com/video/000000012", note:"Most: glute builder (szint 2)." }
            ]
          },
          { week: 4, workouts: [
              { id:"W4-A", title:"Edz√©s A ‚Äî Deload / finom√≠t√°s", desc:"Technika, min≈ës√©g, nem t√∫ler≈ëltet√©s.", video:"https://player.vimeo.com/video/000000013" },
              { id:"W4-B", title:"Edz√©s B ‚Äî Forma-h√©t", desc:"Feszes√≠t√©s + kontroll.", video:"https://player.vimeo.com/video/000000014" },
              { id:"W4-C", title:"Edz√©s C ‚Äî Teszt & z√°r√°s", desc:"√ârz√©s, ism√©tl√©s, r√∂gz√≠t√©s.", video:"https://player.vimeo.com/video/000000015" }
            ],
            slots: [
              { slot:"Slot 1", title:"Szem√©lyre szabott csere", desc:"Z√°r√≥ h√©t finomhangol√°s.", video:"https://player.vimeo.com/video/000000016", note:"Most: mobilit√°s + core reset." }
            ]
          }
        ]
      },
      tech: {
        categories: [
          { id:"tech_squat", name:"Guggol√°s" },
          { id:"tech_hinge", name:"Cs√≠p≈ë-hajl√≠t√°s" },
          { id:"tech_core", name:"Core" },
          { id:"tech_posture", name:"Tart√°s" }
        ],
        items: {
          tech_squat: [
            { id:"T-SQ-1", title:"Guggol√°s ‚Äî alap be√°ll√≠t√°s", desc:"L√°bfej, t√©rd, t√∂rzs. 2‚Äì3 perc.", video:"https://player.vimeo.com/video/000000101" },
            { id:"T-SQ-2", title:"Guggol√°s ‚Äî gyakori hib√°k", desc:"T√©rd befel√©, t√∫l m√©ly, temp√≥.", video:"https://player.vimeo.com/video/000000102" }
          ],
          tech_hinge: [
            { id:"T-HI-1", title:"RDL / cs√≠p≈ë-hajl√≠t√°s ‚Äî alap", desc:"Cs√≠p≈ë h√°tra, semleges gerinc.", video:"https://player.vimeo.com/video/000000103" },
            { id:"T-HI-2", title:"Hinge ‚Äî der√©k v√©delem", desc:"Mit≈ël f√°j, √©s hogyan jav√≠tsd.", video:"https://player.vimeo.com/video/000000104" }
          ],
          tech_core: [
            { id:"T-CO-1", title:"Plank ‚Äî helyes tart√°s", desc:"Lapocka, medence, l√©gz√©s.", video:"https://player.vimeo.com/video/000000105" },
            { id:"T-CO-2", title:"Dead bug ‚Äî kontroll", desc:"Der√©k leszor√≠t, lass√∫ temp√≥.", video:"https://player.vimeo.com/video/000000106" },
            { id:"T-CO-3", title:"L√©gz√©s ‚Äî core aktiv√°l√°s", desc:"R√∂vid drill edz√©s el≈ëtt.", video:"https://player.vimeo.com/video/000000107" }
          ],
          tech_posture: [
            { id:"T-PO-1", title:"Tart√°s ‚Äî v√°ll/nyak", desc:"1‚Äì2 perces gyors fix.", video:"https://player.vimeo.com/video/000000108" },
            { id:"T-PO-2", title:"Mobilit√°s ‚Äî cs√≠p≈ë", desc:"R√∂vid mobilit√°s blokk.", video:"https://player.vimeo.com/video/000000109" }
          ]
        }
      }
    };

    // ===== Storage keys =====
    const KEY_AUTH = "fl_member_auth_v1";
    const KEY_PROFILE = "fl_member_profile_v1";
    const KEY_DONE = "fl_member_done_v1";
    const KEY_DIET = "fl_member_diet_v1";
    const KEY_CHECKIN = "fl_member_checkin_v1";

    // ===== Auth (test) =====
    function getAuth(){
      try{ return JSON.parse(localStorage.getItem(KEY_AUTH) || "null"); }catch{ return null; }
    }
    function setAuth(auth){
      localStorage.setItem(KEY_AUTH, JSON.stringify(auth));
    }
    function clearAuth(){
      localStorage.removeItem(KEY_AUTH);
    }

    function loadProfile(){
      try{
        const p = JSON.parse(localStorage.getItem(KEY_PROFILE) || "null");
        return p || clone(DEMO.profile);
      }catch{
        return clone(DEMO.profile);
      }
    }
    function saveProfile(p){
      localStorage.setItem(KEY_PROFILE, JSON.stringify(p));
    }

    function loadDone(){
      try{ return JSON.parse(localStorage.getItem(KEY_DONE) || "{}"); }catch{ return {}; }
    }
    function saveDone(d){
      localStorage.setItem(KEY_DONE, JSON.stringify(d));
    }

    function loadDietState(){
      try{ return JSON.parse(localStorage.getItem(KEY_DIET) || "{}"); }catch{ return {}; }
    }
    function saveDietState(s){
      localStorage.setItem(KEY_DIET, JSON.stringify(s));
    }

    function loadCheckin(){
      try{ return JSON.parse(localStorage.getItem(KEY_CHECKIN) || "null"); }catch{ return null; }
    }
    function saveCheckin(v){
      localStorage.setItem(KEY_CHECKIN, JSON.stringify(v));
    }

    // ===== UI: Modals =====
    const authOverlay = $("#authOverlay");
    const settingsOverlay = $("#settingsOverlay");
    const infoOverlay = $("#infoOverlay");
    const infoBody = $("#infoBody");
    const infoTitle = $("#infoTitle");

    function openOverlay(overlay){
      overlay.classList.add("is-open");
      overlay.setAttribute("aria-hidden","false");
    }
    function closeOverlay(overlay){
      overlay.classList.remove("is-open");
      overlay.setAttribute("aria-hidden","true");
    }
    function openInfo(title, html){
      infoTitle.textContent = title;
      infoBody.innerHTML = html;
      openOverlay(infoOverlay);
    }

    $("#authClose").addEventListener("click", ()=>closeOverlay(authOverlay));
    $("#settingsClose").addEventListener("click", ()=>closeOverlay(settingsOverlay));
    $("#infoClose").addEventListener("click", ()=>closeOverlay(infoOverlay));

    authOverlay.addEventListener("click",(e)=>{ if(e.target===authOverlay) closeOverlay(authOverlay); });
    settingsOverlay.addEventListener("click",(e)=>{ if(e.target===settingsOverlay) closeOverlay(settingsOverlay); });
    infoOverlay.addEventListener("click",(e)=>{ if(e.target===infoOverlay) closeOverlay(infoOverlay); });

    document.addEventListener("keydown",(e)=>{
      if(e.key==="Escape"){
        [authOverlay, settingsOverlay, infoOverlay].forEach(ov=>{
          if(ov.classList.contains("is-open")) closeOverlay(ov);
        });
      }
    });

    // ===== Mobile menu (safe) =====
    const menuBtn = $("#menuBtn");
    let menuOpen = false;

    function closeMobileNav(){
      $("#mobileNav")?.remove();
      menuOpen = false;
    }

    menuBtn?.addEventListener("click", ()=>{
      if(menuOpen){ closeMobileNav(); return; }
      closeMobileNav();

      menuOpen = true;
      const nav = document.createElement("div");
      nav.id = "mobileNav";
      nav.style.position = "fixed";
      nav.style.top = "64px";
      nav.style.left = "14px";
      nav.style.right = "14px";
      nav.style.zIndex = "60";
      nav.style.background = "rgba(20,12,26,.72)";
      nav.style.border = "1px solid rgba(255,255,255,.10)";
      nav.style.borderRadius = "18px";
      nav.style.backdropFilter = "blur(14px)";
      nav.style.boxShadow = "0 20px 70px rgba(0,0,0,.55)";
      nav.style.padding = "12px";
      nav.innerHTML = `
        <a href="#program" style="display:block; padding:10px 10px; color:rgba(255,255,255,.86)">Programom</a>
        <a href="#etrend" style="display:block; padding:10px 10px; color:rgba(255,255,255,.86)">√âtrend</a>
        <a href="#checkin" style="display:block; padding:10px 10px; color:rgba(255,255,255,.86)">C√©lom & Check-in</a>
        <a href="#technika" style="display:block; padding:10px 10px; color:rgba(255,255,255,.86)">Technika</a>
      `;
      document.body.appendChild(nav);
    });

    document.addEventListener("click",(e)=>{
      const nav = $("#mobileNav");
      if(!nav) return;
      if(e.target === menuBtn) return;
      if(nav.contains(e.target)) { closeMobileNav(); return; }
      // kattint√°s m√°shol: z√°rjuk
      closeMobileNav();
    });

    // ===== Nav active underline =====
    (()=> {
      const links = $$('[data-nav]');
      const sections = links
        .map(a => document.querySelector(a.getAttribute('href')))
        .filter(Boolean);

      const setActive = (id) => {
        links.forEach(a => a.classList.toggle('is-active', a.getAttribute('href') === `#${id}`));
      };

      const io = new IntersectionObserver((entries)=>{
        const visible = entries.filter(e=>e.isIntersecting).sort((a,b)=>b.intersectionRatio-a.intersectionRatio)[0];
        if(visible?.target?.id) setActive(visible.target.id);
      }, { threshold: [0.18, 0.28, 0.4] });

      sections.forEach(s=>io.observe(s));
    })();

    // ===== Render state =====
    let state = {
      profile: loadProfile(),
      done: loadDone(),
      diet: loadDietState(),
      checkin: loadCheckin(),
      weekIdx: 0,
      techCat: DEMO.tech.categories[0]?.id || "tech_core"
    };

    function calcWeekIndex(profile){
      const start = profile.cycleStart;
      const end = profile.cycleEnd;
      const totalDays = Math.max(1, daysBetween(start,end));
      const passedDays = clamp(daysBetween(start, todayISO()), 0, totalDays);
      const weeks = DEMO.packages[profile.package]?.weeks ?? 4;
      const week = clamp(Math.floor((passedDays / totalDays) * weeks) + 1, 1, weeks);
      return week - 1;
    }

    function renderHeader(){
      const p = state.profile;
      const pack = DEMO.packages[p.package] ? p.package : "Start";
      p.package = pack;

      $("#chipPackage").textContent = `Csomag: ${p.package}`;
      $("#pillGoal").textContent = `üéØ C√©l: ${p.goal || "‚Äî"}`;
      $("#pillIntensity").textContent = `‚ö° Szint: ${p.level ? `${p.level}/4` : "‚Äî"}`;
      $("#pillUpdated").textContent = `‚ú® Utols√≥ friss√≠t√©s: ${p.lastUpdated ? fmtDate(p.lastUpdated) : "‚Äî"}`;

      const totalDays = Math.max(1, daysBetween(p.cycleStart, p.cycleEnd));
      const passedDays = clamp(daysBetween(p.cycleStart, todayISO()), 0, totalDays);
      const leftDays = clamp(totalDays - passedDays, 0, totalDays);

      const weeks = DEMO.packages[p.package]?.weeks ?? 4;
      const week = clamp(Math.floor((passedDays / totalDays) * weeks) + 1, 1, weeks);

      $("#lblWeek").textContent = `H√©t: ${week}/${weeks}`;
      $("#lblDays").textContent = `H√°tral√©v≈ë napok: ${leftDays}`;

      const pct = Math.round((passedDays / totalDays) * 100);
      $("#barCycle").style.width = `${pct}%`;

      const status = leftDays === 0
        ? `A csomagod lej√°rt (${fmtDate(p.cycleEnd)}). A Technika Vault tov√°bbra is el√©rhet≈ë.`
        : `Akt√≠v id≈ëszak: ${fmtDate(p.cycleStart)} ‚Äî ${fmtDate(p.cycleEnd)} ‚Ä¢ K√∂vetkez≈ë l√©p√©s: tartsd a ritmust √©s pip√°ld a heti edz√©seket.`;
      $("#subStatus").textContent = status;

      $("#goalTitle").textContent = `üéØ C√©l: ${p.goal || "‚Äî"}`;
      $("#goalDesc").textContent = p.goal
        ? `F√≥kusz: ${p.goal}. Heti check-in seg√≠t finomhangolni a k√∂vetkez≈ë edz√©seket √©s az √©trendet.`
        : `√Åll√≠ts be c√©lt, hogy a program m√©g pontosabban illeszkedjen hozz√°d.`;

      const done = state.checkin?.done ? 1 : 0;
      $("#checkinLabel").textContent = `${done}/1`;
      $("#barCheckin").style.width = `${done*100}%`;

      const expired = leftDays === 0;
      $("#program").style.opacity = expired ? .55 : 1;
      $("#program").style.pointerEvents = expired ? "none" : "auto";
      if(expired){
        $("#motivationBox").textContent = "A Technika Vault √∂r√∂k. A teljes programhoz √∫j√≠ts meg vagy v√°lts csomagot.";
      }
    }

    function renderWeekTabs(){
      const p = state.profile;
      const weeks = DEMO.packages[p.package]?.weeks ?? 4;

      const cur = calcWeekIndex(p);
      state.weekIdx = clamp(state.weekIdx ?? cur, 0, weeks-1);

      const tabs = $("#weekTabs");
      tabs.innerHTML = "";
      for(let i=0;i<weeks;i++){
        const b = document.createElement("button");
        b.className = "tab" + (i===state.weekIdx ? " is-active" : "");
        b.type = "button";
        b.textContent = `H√©t ${i+1}`;
        b.addEventListener("click", ()=>{
          state.weekIdx = i;
          renderProgram();
        });
        tabs.appendChild(b);
      }
    }

    function workoutKey(week, id){ return `w${week}_${id}`; }
    function techKey(cat, id){ return `t_${cat}_${id}`; }

    function renderProgram(){
      renderWeekTabs();

      const p = state.profile;
      const packPlan = DEMO.plans[p.package] || DEMO.plans.Start;
      const weekObj = packPlan[state.weekIdx] || packPlan[0];

      const ul = $("#workoutList");
      ul.innerHTML = "";
      weekObj.workouts.forEach(w=>{
        const key = workoutKey(weekObj.week, w.id);
        const done = !!state.done[key];

        const li = document.createElement("li");
        li.className = "row";

        li.innerHTML = `
          <div>
            <div class="title">${escapeHtml(w.title)} ${done ? ' <span class="chip" style="margin-left:6px;">‚úÖ k√©sz</span>' : ''}</div>
            <div class="desc">${escapeHtml(w.desc)}</div>
          </div>
          <div class="actions">
            <button class="pill ghost tiny" data-play="${escapeHtml(w.video)}">‚ñ∂ Lej√°tsz√°s</button>
            <button class="pill ${done ? 'danger' : 'primary'} tiny" data-toggle-done="${escapeHtml(key)}">${done ? 'Visszavon' : 'K√©sz'}</button>
          </div>
        `;
        ul.appendChild(li);
      });

      const sl = $("#slotList");
      sl.innerHTML = "";
      weekObj.slots.forEach((s, idx)=>{
        const key = `slot_w${weekObj.week}_${idx}`;
        const li = document.createElement("li");
        li.className = "row";
        li.innerHTML = `
          <div>
            <div class="title">${escapeHtml(s.slot)} ‚Äî ${escapeHtml(s.title)}</div>
            <div class="desc">${escapeHtml(s.desc)}<br><span style="color:rgba(255,255,255,.72); font-size:12.6px;">Megjegyz√©s: ${escapeHtml(s.note||"‚Äî")}</span></div>
          </div>
          <div class="actions">
            <button class="pill ghost tiny" data-play="${escapeHtml(s.video)}">‚ñ∂ Lej√°tsz√°s</button>
            <button class="pill ghost tiny" data-request-swap="${escapeHtml(key)}">üîÅ Csere k√©r√©se</button>
          </div>
        `;
        sl.appendChild(li);
      });

      $$("[data-play]").forEach(b=>{
        b.addEventListener("click", ()=>{
          const url = b.getAttribute("data-play");
          openInfo("Lej√°tsz√°s (teszt)", `
            <p class="note">Teszt m√≥dban a vide√≥ hely√©re Vimeo embed linket mutatunk. √âlesben itt j√∂n a domain-lockolt Vimeo lej√°tsz√≥.</p>
            <div class="row" style="grid-template-columns: 1fr;">
              <div class="title">Vimeo embed URL</div>
              <div class="desc"><code style="white-space:pre-wrap; word-break:break-word;">${escapeHtml(url)}</code></div>
            </div>
            <p class="note" style="margin-top:10px;">
              Vimeo be√°gyaz√°s: <b>Hide from Vimeo</b> + <b>Embed only on fitnesslady.ch</b> + <b>Download off</b>.
            </p>
          `);
        });
      });

      $$("[data-toggle-done]").forEach(b=>{
        b.addEventListener("click", ()=>{
          const key = b.getAttribute("data-toggle-done");
          state.done[key] = !state.done[key];
          saveDone(state.done);
          renderProgram();
        });
      });

      $$("[data-request-swap]").forEach(b=>{
        b.addEventListener("click", ()=>{
          openInfo("Csere k√©r√©se (teszt)", `
            <p>Ez a gomb √©lesben egy egyszer≈± k√©r√©s lehet Edin√°nak (WhatsApp/Email), vagy egy admin ‚Äúto-do‚Äù.</p>
            <p class="note">Most csak teszt √ºzenetet mutatunk:</p>
            <div class="row" style="grid-template-columns: 1fr;">
              <div class="title">√úzenet minta</div>
              <div class="desc">
                <code style="white-space:pre-wrap; word-break:break-word;">
Szia Edina! K√©rlek n√©zd meg a heti szem√©lyre szab√°s slotomat (H√©t ${weekObj.week}).
√ögy √©rzem: [t√∫l k√∂nny≈± / t√∫l neh√©z / f√°j a t√©rdem / t√∂bb glute f√≥kusz]. K√∂szi! üòä
                </code>
              </div>
            </div>
          `);
        });
      });
    }

    function renderTechnika(){
      const tabs = $("#techTabs");
      tabs.innerHTML = "";
      DEMO.tech.categories.forEach(c=>{
        const b = document.createElement("button");
        b.className = "tab" + (c.id===state.techCat ? " is-active" : "");
        b.type = "button";
        b.textContent = c.name;
        b.addEventListener("click", ()=>{
          state.techCat = c.id;
          renderTechnika();
        });
        tabs.appendChild(b);
      });

      const list = $("#techList");
      list.innerHTML = "";
      const items = DEMO.tech.items[state.techCat] || [];
      items.forEach(it=>{
        const key = techKey(state.techCat, it.id);
        const done = !!state.done[key];

        const li = document.createElement("li");
        li.className = "row";
        li.innerHTML = `
          <div>
            <div class="title">${escapeHtml(it.title)} ${done ? ' <span class="chip" style="margin-left:6px;">‚úÖ megvolt</span>' : ''}</div>
            <div class="desc">${escapeHtml(it.desc)}</div>
          </div>
          <div class="actions">
            <button class="pill ghost tiny" data-play="${escapeHtml(it.video)}">‚ñ∂ Lej√°tsz√°s</button>
            <button class="pill ${done ? 'danger' : 'primary'} tiny" data-toggle-tech="${escapeHtml(key)}">${done ? 'Visszavon' : 'Megvolt'}</button>
          </div>
        `;
        list.appendChild(li);
      });

      $$("[data-toggle-tech]").forEach(b=>{
        b.addEventListener("click", ()=>{
          const key = b.getAttribute("data-toggle-tech");
          state.done[key] = !state.done[key];
          saveDone(state.done);
          renderTechnika();
        });
      });

      $$("[data-play]").forEach(b=>{
        b.addEventListener("click", ()=>{
          const url = b.getAttribute("data-play");
          openInfo("Lej√°tsz√°s (teszt)", `
            <p class="note">Teszt m√≥dban csak a Vimeo embed URL-t mutatjuk.</p>
            <div class="row" style="grid-template-columns: 1fr;">
              <div class="title">Vimeo embed URL</div>
              <div class="desc"><code style="white-space:pre-wrap; word-break:break-word;">${escapeHtml(url)}</code></div>
            </div>
          `);
        });
      });
    }

    // ===== Buttons / Actions =====
    $("#btnMarkAll").addEventListener("click", ()=>{
      const p = state.profile;
      const packPlan = DEMO.plans[p.package] || DEMO.plans.Start;
      const weekObj = packPlan[state.weekIdx] || packPlan[0];
      weekObj.workouts.forEach(w=>{
        state.done[workoutKey(weekObj.week, w.id)] = true;
      });
      saveDone(state.done);
      renderProgram();
    });

    $("#btnResetWeek").addEventListener("click", ()=>{
      const p = state.profile;
      const packPlan = DEMO.plans[p.package] || DEMO.plans.Start;
      const weekObj = packPlan[state.weekIdx] || packPlan[0];
      weekObj.workouts.forEach(w=>{
        delete state.done[workoutKey(weekObj.week, w.id)];
      });
      saveDone(state.done);
      renderProgram();
    });

    $("#btnAddTechDone").addEventListener("click", ()=>{
      const items = DEMO.tech.items[state.techCat] || [];
      items.forEach(it=>{
        state.done[techKey(state.techCat, it.id)] = true;
      });
      saveDone(state.done);
      renderTechnika();
    });

    $("#btnOpenPlayerHelp").addEventListener("click", ()=>{
      openInfo("Lej√°tsz√°s ‚Äî hogyan lesz √©lesben?", `
        <p><b>Teszt verzi√≥</b>: csak URL-t mutatunk.</p>
        <p><b>√âles verzi√≥</b>: Vimeo embed lej√°tsz√≥ jelenik meg, domain-lockkal.</p>
        <ul style="color:rgba(255,255,255,.78); line-height:1.65; font-size:13.5px;">
          <li>Vimeo: <b>Hide from Vimeo</b></li>
          <li>Embed: <b>Only on fitnesslady.ch</b></li>
          <li>Download: <b>OFF</b></li>
        </ul>
      `);
    });

    $("#btnRenew").addEventListener("click", ()=>{
      openInfo("Meg√∫j√≠t√°s (teszt)", `
        <p class="note">√âlesben ez Payrexx/Stripe checkout-ra visz (meg√∫j√≠t√°s). Tesztben csak visszajelz√©st adunk.</p>
        <div class="row" style="grid-template-columns: 1fr;">
          <div class="title">Mit kapsz meg√∫j√≠t√°skor?</div>
          <div class="desc">√öj blokk + √∫j heti szem√©lyre szab√°s slot friss√≠t√©sek.</div>
        </div>
      `);
    });

    $("#btnUpgrade").addEventListener("click", ()=>{
      openInfo("Upgrade (teszt)", `
        <p class="note">√âlesben itt tud Start ‚Üí Balance ‚Üí Pro v√°ltani. Tesztben a Be√°ll√≠t√°sokban √°t tudod √°ll√≠tani a csomagot.</p>
        <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
          <button class="pill primary tiny" onclick="document.getElementById('btnOpenSettings').click()">Be√°ll√≠t√°sok megnyit√°sa</button>
        </div>
      `);
    });

    function refreshDietButtons(){
      const d = state.diet;
      $$("[data-toggle]").forEach(btn=>{
        const key = btn.getAttribute("data-toggle");
        const on = !!d[key];
        btn.classList.toggle("primary", on);
        btn.classList.toggle("ghost", !on);
      });
    }
    $$("[data-toggle]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const key = btn.getAttribute("data-toggle");
        state.diet[key] = !state.diet[key];
        saveDietState(state.diet);
        refreshDietButtons();
      });
    });

    $("#btnDietPlan").addEventListener("click", ()=>{
      openInfo("Napi √©tkez√©s (teszt)", `
        <p class="note">K√©s≈ëbb itt lesz a napi bont√°s (Reggeli/Eb√©d/Vacsora/Snack). K√©pet opcion√°lisan √©tkez√©senk√©nt 1 db-ot javaslok.</p>
        <div class="row" style="grid-template-columns: 1fr;">
          <div class="title">Reggeli (minta)</div>
          <div class="desc">Zabk√°sa 60g + g√∂r√∂g joghurt 200g + bogy√≥s 100g</div>
        </div>
        <div class="row" style="grid-template-columns: 1fr;">
          <div class="title">Eb√©d (minta)</div>
          <div class="desc">Csirke 150g + rizs 70g (sz√°raz) + sal√°ta</div>
        </div>
        <div class="row" style="grid-template-columns: 1fr;">
          <div class="title">Vacsora (minta)</div>
          <div class="desc">Lazac 150g + z√∂lds√©g + burgonya 250g</div>
        </div>
      `);
    });

    $("#btnDietPrefs").addEventListener("click", ()=>{
      openInfo("Preferenci√°k (teszt)", `
        <p class="note">√âlesben itt k√©rdezz√ºk: allergia, kedvencek, edz√©snap/pihen≈ënap sablon, √©tkez√©ssz√°m.</p>
        <div class="row" style="grid-template-columns: 1fr;">
          <div class="title">Gyors k√©rd√©sek</div>
          <div class="desc">C√©l ‚Ä¢ heti edz√©snapok ‚Ä¢ otthon/terem ‚Ä¢ korl√°toz√°s ‚Ä¢ √©tkez√©ssz√°m</div>
        </div>
      `);
    });

    const MOTS = [
      "‚ÄûA rendszer nem nyom√°s. A rendszer szabads√°g.‚Äù",
      "‚ÄûA halad√°s nem t√∂k√©letess√©g. Hanem k√∂vetkezetess√©g.‚Äù",
      "‚ÄûNem csak form√°t √©p√≠tesz ‚Äì bizalmat √©s j√∂v≈ët.‚Äù",
      "‚ÄûAmit ma megteszel, az a holnapi √∂nbizalmad.‚Äù"
    ];
    $("#btnMotivation").addEventListener("click", ()=>{
      const m = MOTS[Math.floor(Math.random()*MOTS.length)];
      $("#motivationBox").textContent = m;
    });

    $("#btnDoCheckin").addEventListener("click", ()=>{
      openInfo("Check-in (teszt)", `
        <p class="note">√âlesben ez lehet egy ≈±rlap (Tally/Typeform), vagy saj√°t mini form.</p>
        <h4>Gyors check-in k√©rd√©sek</h4>
        <ul style="color:rgba(255,255,255,.78); line-height:1.65; font-size:13.5px;">
          <li>Hogy ment a h√©t? (1‚Äì10)</li>
          <li>Energia / alv√°s rendben?</li>
          <li>Volt f√°jdalom/korl√°toz√°s?</li>
          <li>K√∂vetkez≈ë h√©t f√≥kusz: glute / core / √°ll√≥k√©pess√©g</li>
        </ul>
        <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
          <button class="pill primary tiny" id="btnConfirmCheckin" type="button">‚úÖ Check-in k√©sz (teszt)</button>
        </div>
      `);

      setTimeout(()=>{
        const c = $("#btnConfirmCheckin");
        if(!c) return;
        c.addEventListener("click", ()=>{
          state.checkin = { done: true, at: new Date().toISOString() };
          saveCheckin(state.checkin);
          closeOverlay(infoOverlay);
          renderHeader();
        });
      }, 0);
    });

    $("#btnOpenSettings").addEventListener("click", ()=>{
      const p = state.profile;
      $("#setPackage").value = p.package || "Start";
      $("#setGoal").value = p.goal || "";
      $("#setLevel").value = p.level || 2;
      $("#setStart").value = p.cycleStart || todayISO();
      $("#setEnd").value = p.cycleEnd || todayISO();
      openOverlay(settingsOverlay);
    });

    $("#btnSaveSettings").addEventListener("click", ()=>{
      const p = state.profile;
      p.package = ($("#setPackage").value || "Start").trim();
      p.goal = ($("#setGoal").value || "Form√°l√°s").trim();
      p.level = clamp(parseInt($("#setLevel").value || "2",10),1,4);
      p.cycleStart = ($("#setStart").value || todayISO()).trim();
      p.cycleEnd = ($("#setEnd").value || todayISO()).trim();
      p.lastUpdated = todayISO();
      state.profile = p;
      saveProfile(p);
      closeOverlay(settingsOverlay);
      renderAll();
    });

    $("#btnResetDemo").addEventListener("click", ()=>{
      localStorage.removeItem(KEY_PROFILE);
      localStorage.removeItem(KEY_DONE);
      localStorage.removeItem(KEY_DIET);
      localStorage.removeItem(KEY_CHECKIN);
      state.profile = loadProfile();
      state.done = loadDone();
      state.diet = loadDietState();
      state.checkin = loadCheckin();
      closeOverlay(settingsOverlay);
      renderAll();
    });

    // Logout: t√∂r√∂lj√ºk auth-ot, √©s visszadobjuk bel√©p√©sre (teszt)
    $("#btnLogout").addEventListener("click", ()=>{
      clearAuth();
      openAuth(true);
    });

    // ===== Auth UI =====
    function openAuth(force=false){
      $("#authMsg").textContent = "";
      openOverlay(authOverlay);

      const email = $("#email");
      const auth = getAuth();
      email.value = auth?.email || DEMO.profile.email;

      $("#activateBlock").style.display = "block";
      $("#loginBlock").style.display = "block";
      $("#pw").value = "";
      $("#pw1").value = "";
      $("#pw2").value = "";

      // ha nem force √©s m√°r ‚Äúvan auth‚Äù, akkor nem kell mindig popup (stabil vev≈ë √©lm√©ny)
      // a bel√©p√©shez √≠gy is kell Login gomb, mert demo
      if (!force && auth?.email && auth?.passHash) {
        // csak a login r√©sz maradjon hangs√∫lyos
      }
    }

    function hashPassword(pw){
      // demo hash (NEM production)
      let h = 0;
      for(let i=0;i<pw.length;i++){ h = (h*31 + pw.charCodeAt(i)) >>> 0; }
      return "h"+h.toString(16);
    }

    $("#btnActivate").addEventListener("click", ()=>{
      const email = ($("#email").value || "").trim().toLowerCase();
      const pw1 = $("#pw1").value || "";
      const pw2 = $("#pw2").value || "";

      if(!email || !email.includes("@")){
        $("#authMsg").textContent = "Adj meg egy √©rv√©nyes e-mailt.";
        return;
      }
      if(pw1.length < 6){
        $("#authMsg").textContent = "A jelsz√≥ legyen legal√°bb 6 karakter.";
        return;
      }
      if(pw1 !== pw2){
        $("#authMsg").textContent = "A k√©t jelsz√≥ nem egyezik.";
        return;
      }

      setAuth({ email, passHash: hashPassword(pw1), createdAt: new Date().toISOString() });

      const p = loadProfile();
      p.email = email;
      saveProfile(p);

      $("#authMsg").textContent = "Fi√≥k aktiv√°lva. Most bel√©phetsz.";
    });

    $("#btnLogin").addEventListener("click", ()=>{
      const email = ($("#email").value || "").trim().toLowerCase();
      const pw = $("#pw").value || "";
      const auth = getAuth();

      if(!auth){
        $("#authMsg").textContent = "Nincs aktiv√°lt fi√≥k ehhez a b√∂ng√©sz≈ëh√∂z. El≈ëbb aktiv√°ld fel√ºl.";
        return;
      }
      if(auth.email !== email){
        $("#authMsg").textContent = "Ez az e-mail nem egyezik az aktiv√°lt fi√≥kkal (teszt).";
        return;
      }
      if(auth.passHash !== hashPassword(pw)){
        $("#authMsg").textContent = "Hib√°s jelsz√≥.";
        return;
      }

      closeOverlay(authOverlay);
      state.profile = loadProfile();
      state.done = loadDone();
      state.diet = loadDietState();
      state.checkin = loadCheckin();
      renderAll();
    });

    $("#btnResetPw").addEventListener("click", ()=>{
      openInfo("Elfelejtett jelsz√≥ (teszt)", `
        <p class="note">√âlesben e-mailes jelsz√≥-vissza√°ll√≠t√°s lesz. Tesztben csak t√∂r√∂lj√ºk a fi√≥kot, √©s √∫jra aktiv√°lod.</p>
        <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
          <button class="pill danger tiny" id="btnDoResetAuth" type="button">Fi√≥k t√∂rl√©se (teszt)</button>
        </div>
      `);
      setTimeout(()=>{
        $("#btnDoResetAuth")?.addEventListener("click", ()=>{
          clearAuth();
          closeOverlay(infoOverlay);
          $("#authMsg").textContent = "Fi√≥k t√∂r√∂lve. Aktiv√°ld √∫jra fel√ºl.";
          openAuth(true);
        });
      }, 0);
    });

    // ===== Render all =====
    function renderAll(){
      renderHeader();
      renderProgram();
      renderTechnika();
      refreshDietButtons();
      enableTapGlow();
    }

    // ===== Init =====
    document.getElementById("y").textContent = new Date().getFullYear();

    // Demo: ha nincs auth, akkor k√©rj√ºk a bel√©p√©st; ha van, akkor bet√∂ltj√ºk a fel√ºletet √©s nem dob√°ljuk fel mindig a modalt
    const auth = getAuth();
    if(!auth){
      openAuth(true);
    }else{
      // bet√∂ltj√ºk a fel√ºletet, √©s a user akkor nyom login-t amikor akar (demo)
      renderAll();
    }
  </script>
</body>
</html>
